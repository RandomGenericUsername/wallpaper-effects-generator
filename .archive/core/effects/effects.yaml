version: "1.0"

# Reusable parameter type definitions
parameter_types:
  blur_geometry:
    type: string
    pattern: "^\\d+x\\d+$"
    default: "0x8"
    description: "Blur geometry in format RADIUSxSIGMA (e.g., 0x8)"

  percent:
    type: integer
    min: -100
    max: 100
    default: 0
    description: "Percentage value (-100 to 100)"

  color_hex:
    type: string
    pattern: "^#[0-9a-fA-F]{6}$"
    default: "#000000"
    description: "Hex color code (e.g., #ff5500)"

  opacity:
    type: float
    min: 0.0
    max: 1.0
    default: 0.5
    description: "Opacity value (0.0 to 1.0)"

# Atomic effects (single magick command)
effects:
  blur:
    description: "Apply Gaussian blur"
    command: 'magick "$INPUT" -blur "$BLUR" "$OUTPUT"'
    parameters:
      blur:
        type: blur_geometry
        cli_flag: "--blur"
        description: "Blur geometry (RADIUSxSIGMA)"

  blackwhite:
    description: "Convert to grayscale"
    command: 'magick "$INPUT" -grayscale Average "$OUTPUT"'

  negate:
    description: "Invert colors"
    command: 'magick "$INPUT" -channel RGB -negate +channel "$OUTPUT"'

  brightness:
    description: "Adjust brightness/contrast"
    command: 'magick "$INPUT" -brightness-contrast "$BRIGHTNESS"% "$OUTPUT"'
    parameters:
      brightness:
        type: percent
        cli_flag: "--brightness"
        default: -20
        description: "Brightness adjustment percentage"

  contrast:
    description: "Adjust contrast"
    command: 'magick "$INPUT" -brightness-contrast 0x"$CONTRAST"% "$OUTPUT"'
    parameters:
      contrast:
        type: percent
        cli_flag: "--contrast"
        default: 20
        description: "Contrast adjustment percentage"

  saturation:
    description: "Adjust color saturation"
    command: 'magick "$INPUT" -modulate 100,"$SATURATION",100 "$OUTPUT"'
    parameters:
      saturation:
        type: integer
        cli_flag: "--saturation"
        default: 100
        description: "Saturation level (100 = normal, 0 = grayscale, 200 = double)"

  sepia:
    description: "Apply sepia tone effect"
    command: 'magick "$INPUT" -sepia-tone 80% "$OUTPUT"'

  vignette:
    description: "Apply vignette effect"
    command: 'magick "$INPUT" -vignette 0x"$STRENGTH" "$OUTPUT"'
    parameters:
      strength:
        type: integer
        cli_flag: "--strength"
        default: 50
        description: "Vignette strength"

  color_overlay:
    description: "Apply color overlay"
    command: 'magick "$INPUT" -fill "$COLOR" -colorize "$OPACITY"% "$OUTPUT"'
    parameters:
      color:
        type: color_hex
        cli_flag: "--color"
        default: "#000000"
        description: "Overlay color"
      opacity:
        type: integer
        cli_flag: "--opacity"
        default: 30
        description: "Overlay opacity percentage (0-100)"

# Composite effects (chains of atomic effects)
composites:
  blur-brightness80:
    description: "Blur then dim to 80% brightness"
    chain:
      - effect: blur
        params: { blur: "0x8" }
      - effect: brightness
        params: { brightness: -20 }

  blackwhite-blur:
    description: "Convert to grayscale then blur"
    chain:
      - effect: blackwhite
      - effect: blur
        params: { blur: "0x8" }

  blackwhite-brightness80:
    description: "Convert to grayscale then dim"
    chain:
      - effect: blackwhite
      - effect: brightness
        params: { brightness: -20 }

  negate-brightness80:
    description: "Invert colors then adjust brightness"
    chain:
      - effect: negate
      - effect: brightness
        params: { brightness: 20 }

# Presets (named configurations)
presets:
  dark_blur:
    description: "Dark blurred background for overlays"
    composite: blur-brightness80

  subtle_blur:
    description: "Gentle blur effect"
    effect: blur
    params: { blur: "0x4" }

  dim:
    description: "Slightly dimmed image"
    effect: brightness
    params: { brightness: -30 }

  high_contrast:
    description: "High contrast effect"
    effect: contrast
    params: { contrast: 40 }

  desaturated:
    description: "Reduced color saturation"
    effect: saturation
    params: { saturation: 50 }

  warm_overlay:
    description: "Warm orange tint"
    effect: color_overlay
    params: { color: "#ff8800", opacity: 20 }

  cool_overlay:
    description: "Cool blue tint"
    effect: color_overlay
    params: { color: "#0088ff", opacity: 20 }

